{% extends "admin/admin_base.html" %}

{% block title %}Admin Reporting{% endblock %}

{% block admin_content %}
<h1>Admin Reporting</h1>

<form method="post">
    {% csrf_token %}
    <div class="form-group">
        <label for="user">Select User:</label>
        <select id="user" name="user" class="form-control">
            {% for user in users %}
                <option value="{{ user.id }}" {% if selected_user and user.id == selected_user.id %}selected{% endif %}>{{ user.username }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="form-group">
        <label for="start_date">Select Week Starting Monday:</label>
        <input type="date" id="start_date" name="start_date" class="form-control" value="{{ start_date }}" required>
    </div>
    <button type="submit" class="btn btn-primary">Generate Report</button>
</form>

{% if selected_user %}
    <h2>Report for {{ selected_user.username }}</h2>
    <p>Total Hours: {{ total_hours }}</p>
    <p>Total Pay: {{ total_pay }}</p>

    <table class="table table-striped">
        <thead>
            <tr>
                <th>Date</th>
                <th>Start Time</th>
                <th>End Time</th>
                <th>Location</th>
                <th>Hours Done</th>
                <th>Sleep In</th>
                <th>Amount Paid</th>
            </tr>
        </thead>
        <tbody>
            {% for shift in shifts %}
                <tr>
                    <td>{{ shift.date }}</td>
                    <td>{{ shift.start_time }}</td>
                    <td>{{ shift.end_time }}</td>
                    <td>{{ shift.location.name }}</td>
                    <td>{{ shift.hours_done }}</td>
                    <td>{{ shift.sleep_in|yesno:"Yes,No" }}</td>
                    <td>{{ shift.shift_pay }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
{% endif %}
{% endblock %}